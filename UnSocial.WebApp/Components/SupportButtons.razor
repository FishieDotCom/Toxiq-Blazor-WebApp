@using Microsoft.AspNetCore.Components.Web
@using Microsoft.AspNetCore.Components

<div class="support-buttons" style="@GetContainerStyle()">
    <button class="@GetUpvoteButtonClass()" @onclick="HandleUpvote" @onclick:stopPropagation style="@GetButtonStyle(false)">
        <div>
            @if (SupportStatus == true)
            {
                <svg width="17.75" height="17.75" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.057 9.004c.46-1.427.693-2.676.693-3.753 0-2.399-.939-4.248-2.5-4.248-.847 0-1.109.505-1.437 1.747.017-.065-.163.634-.215.821-.101.36-.277.97-.527 1.831a.247.247 0 0 1-.03.065L8.175 9.953A5.885 5.885 0 0 1 5.32 12.28l-1.257.481a1.75 1.75 0 0 0-1.092 1.968l.686 3.538a2.25 2.25 0 0 0 1.673 1.757l8.25 2.022a4.75 4.75 0 0 0 5.733-3.44l1.574-6.173a2.75 2.75 0 0 0-2.665-3.429h-3.165Z" fill="currentColor" /></svg>
            }
            else
            {
                <svg width="17.75" height="17.75" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5 5.202c0-2.442-1.14-4.199-3.007-4.199-1.026 0-1.378.602-1.746 2-.075.289-.112.43-.151.568-.101.359-.277.97-.527 1.831a.25.25 0 0 1-.03.065L8.174 9.953a5.885 5.885 0 0 1-2.855 2.326l-.473.181a2.75 2.75 0 0 0-1.716 3.092l.404 2.086a3.25 3.25 0 0 0 2.417 2.538l7.628 1.87a4.75 4.75 0 0 0 5.733-3.44l1.415-5.55a3.25 3.25 0 0 0-3.15-4.052h-1.822c.496-1.633.746-2.893.746-3.802ZM4.6 15.267a1.25 1.25 0 0 1 .78-1.406l.474-.18a7.385 7.385 0 0 0 3.582-2.92l2.867-4.486c.09-.141.159-.294.205-.455.252-.865.428-1.479.53-1.843.044-.153.085-.308.159-.592.19-.722.283-.882.295-.882.868 0 1.507.984 1.507 2.7 0 .884-.326 2.335-.984 4.314a.75.75 0 0 0 .711.987h2.85a1.751 1.751 0 0 1 1.696 2.182l-1.415 5.55a3.25 3.25 0 0 1-3.923 2.353l-7.628-1.87a1.75 1.75 0 0 1-1.301-1.366L4.6 15.267Z" fill="currentColor" /></svg>
            }
        </div>
        @if (ShowCount)
        {
            <span>@SupportCount</span>
        }
    </button>

    <button class="@GetDownvoteButtonClass()" @onclick="HandleDownvote" @onclick:stopPropagation style="@GetButtonStyle(true)">
        <div>
            @if (SupportStatus == false)
            {
                <svg width="17.75" height="17.75" fill="none" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M15.057 14.183c.46 1.427.693 2.676.693 3.753 0 2.399-.939 4.248-2.5 4.248-.8 0-1.078-.45-1.383-1.547l-.27-1.021c-.1-.359-.276-.97-.526-1.831a.246.246 0 0 0-.03-.065l-2.866-4.486a5.886 5.886 0 0 0-2.855-2.327l-1.257-.48A1.75 1.75 0 0 1 2.97 8.458l.686-3.539A2.25 2.25 0 0 1 5.33 3.163l8.25-2.022a4.75 4.75 0 0 1 5.733 3.44l1.574 6.173a2.75 2.75 0 0 1-2.665 3.429h-3.165Z" fill="currentColor" /></svg>
            }
            else
            {
                <svg width="17.75" height="17.75" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M16.5 17.985c0 2.442-1.14 4.198-3.007 4.198-.975 0-1.341-.542-1.69-1.795l-.207-.772c-.101-.359-.277-.97-.527-1.831a.249.249 0 0 0-.03-.065l-2.866-4.486a5.886 5.886 0 0 0-2.855-2.327l-.473-.18A2.75 2.75 0 0 1 3.13 7.634l.404-2.087A3.25 3.25 0 0 1 5.95 3.011l7.628-1.87a4.75 4.75 0 0 1 5.733 3.44l1.415 5.55a3.25 3.25 0 0 1-3.15 4.052h-1.822c.496 1.633.746 2.893.746 3.802ZM4.6 7.92a1.25 1.25 0 0 0 .78 1.405l.474.182a7.385 7.385 0 0 1 3.582 2.92l2.867 4.485c.09.14.159.294.205.454l.552 1.92.212.792c.14.488.21.605.22.605.868 0 1.507-.984 1.507-2.698 0-.885-.326-2.336-.984-4.315a.75.75 0 0 1 .711-.987h2.85a1.751 1.751 0 0 0 1.696-2.182l-1.415-5.55a3.25 3.25 0 0 0-3.923-2.353l-7.628 1.87a1.75 1.75 0 0 0-1.301 1.366L4.6 7.92Z" fill="currentColor" /></svg>
            }
        </div>
    </button>
</div>

@code {
    [Parameter] public bool? SupportStatus { get; set; }
    [Parameter] public int? SupportCount { get; set; }
    [Parameter] public EventCallback OnUpvote { get; set; }
    [Parameter] public EventCallback OnDownvote { get; set; }
    [Parameter] public string Variant { get; set; } = "post";
    [Parameter] public bool ShowCount { get; set; } = true;

    private string GetContainerStyle()
    {
        var baseStyle = "display: flex; align-items: center;";
        return Variant == "comment" ? $"{baseStyle} scale: 0.8;" : baseStyle;
    }

    private string GetButtonStyle(bool isDislike)
    {
        string style = @"display: flex;
                align-items: center;
                justify-content: center;
             
                background-color: rgba(255, 255, 255, 0.1);
                border: none;
                padding: 8px 12px;
                cursor: pointer;
                color: white;
                transition: background-color 0.2s ease;";


        if(isDislike)
        {
            style = style + "border-top-right-radius: 15px;border-bottom-right-radius: 15px;";
        }
        else
        {
            style = style + "border-bottom-left-radius: 14px;border-top-left-radius: 15px;";
        }

        return style;
    }

    private string GetUpvoteButtonClass()
    {
        var baseClass = "upvote-button";
        return SupportStatus == true ? $"{baseClass} active" : baseClass;
    }

    private string GetDownvoteButtonClass()
    {
        var baseClass = "downvote-button";
        return SupportStatus == false ? $"{baseClass} active" : baseClass;
    }



    private async Task HandleUpvote()
    {
        if (OnUpvote.HasDelegate)
        {
            await OnUpvote.InvokeAsync();
        }
    }

    private async Task HandleDownvote()
    {
        if (OnDownvote.HasDelegate)
        {
            await OnDownvote.InvokeAsync();
        }
    }
}

<style>
    .support-buttons button:hover {
        background-color: rgba(255, 255, 255, 0.2);
    }

    .support-buttons .active {
        color: var(--accent-color);
    }

    .support-buttons i {
        font-size: 16px;
    }

    .support-buttons span {
        font-weight: bold;
        font-size: 14px;
    }
</style>